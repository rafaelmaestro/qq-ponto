<html>

<head>
    <!DOCTYPE html>
    <meta charset="utf-8" />
    <title>QQPonto - Pontos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" 
    rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" 
    crossorigin="anonymous">  
    <link rel="stylesheet" href="../css/pontos.css">
    <link rel="shortcut icon" href="../projeto/favicon.ico">
</head>
<body>
                <nav class="dp-menu">
                <ul>
                  <span>
                      <img src="../cc/logomenor1.png"/>
                  </span>
                    <li class="home"><a href="/inicial">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-fill" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6zm5-.793V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
                        <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
                      </svg>
                    </a></li>
                    <li class="pontos"><a href="/inicial/pontos">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-check-fill" viewBox="0 0 16 16">
                      <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4V.5zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2zm-5.146-5.146-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708z"/>
                      </svg>
                    </a></li>
                    <li><a href="/inicial/exportar">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-arrow-down-fill" viewBox="0 0 16 16">
                      <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zm-1 4v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 11.293V7.5a.5.5 0 0 1 1 0z"/>
                      </svg>  
                    </a></li>
                    <li id="cadastro" data-bs-toggle="modal" data-bs-target="#staticBackdrop"><a href="/inicial/cadastro">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-plus-fill" viewBox="0 0 16 16">
                        <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                        <path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z"/>
                      </svg>
                    </a></li>
                    <li id="acesso" data-bs-toggle="modal" data-bs-target="#staticBackdrop"><a href="/inicial/retirar-acesso">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash-circle-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-7z"/>
                      </svg>
                    </a></li>
                    <li id="senha"><a href="/inicial/alterar-senha">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
                        <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                        <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                      </svg>
                    </a>
                    </li>
                </ul>
            </nav>]
    <div id="tela2">
      <h1>Pontos registrados</h1>
      <fieldset>
        <span class="relogio">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock-fill" viewBox="0 0 16 16">
            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
          </svg>
        </span>
        <span class="horasTotais">Total de horas mensal:</span>
        <span id="numHoras">hh:mm</span>
        <hr class="linha" size="3" width="100%">
          <form id="excluirPonto" method="post" action="" name="">
            <label for="excluirPonto">Excluir Registro: </label>
            <input type="text" required name="idPontoExcluir" placeholder="ID" 
            onkeypress="if (!isNaN(String.fromCharCode(window.event.keyCode))) return true; else return false;">
            <button>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square-fill" viewBox="0 0 16 16">
                <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708z"/>
              </svg>
            </button>
          </form>

          <div id="cabeId">ID Ponto</div>
          <div id="cabeData">Data Ponto</div>
          <div id="cabeTipo">Tipo Ponto</div>
          
        <table id="pontosRegistrados">
          <tr>
            <td id="dadosPontos">
              id
            </td>
            <td id="dadosPontos" class="data">
              dd/mm/aaaa
            </td>
            <td id="dadosPontos" class="tipo">
              entrada
            </td>
            <td id="dadosPontos" class="obs">
              Obs
            </td>
          </tr>
        </table>
      </fieldset>

    </div>
    <span class="logobottom">
      <img src="/cc/abc.png">
    </span>
    <!-- Modal Acesso -->

<!-- --------------------------------------------------------------------------------------- -->

</body>
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" 
integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" 
crossorigin="anonymous"></script>
<script src="../js/javascriptPontos.js"></script>
<script>

async function horas() {
  const response = await fetch('/horas')
  const data = await response.json()
  const response2 = await fetch('/pontosreg')
  const data2 = await response2.json()
  console.log(data[0][0].seconds)
  console.log(data2)

  let horas   = Math.floor(data[0][0].seconds / 3600) // get hours
  let minutos = Math.floor((data[0][0].seconds - (horas * 3600)) / 60) // get minutes
  let segundos = data[0][0].seconds - (horas * 3600) - (minutos * 60) //  get seconds
  // add 0 if value < 10; Example: 2 => 02
  if (horas   < 10) {horas   = "0"+horas}
  if (minutos < 10) {minutos = "0"+minutos}
  if (segundos < 10) {segundos = "0"+segundos} 

  var container = document.getElementById('numHoras')
  container.innerHTML = ''
  if (data2[0].length % 2 != 0) {
    container.innerHTML += `Existem Entrada(s) e/ou SaÃ­da(s) sem registro(s).`
  } else {
    container.innerHTML += `${horas} horas e ${minutos} minutos.`
  }
}

horas()






async function carregar() {
  const response = await fetch('/pontosreg')
  const data = await response.json()
  console.log(data[0])

  let ponto = ''
  for (const u of data[0]) {

  const formatedDate = new Date(u.data_ponto)

  const dia = (formatedDate.getDate() <= 9 ? '0' + formatedDate.getDate() : formatedDate.getDate()) + "/" + ((formatedDate.getMonth() + 1) <= 9 ? '0' + (formatedDate.getMonth() + 1) : (formatedDate.getMonth() + 1)) + "/" + formatedDate.getFullYear()

  const hora = (formatedDate.getHours() <= 9 ? '0' + formatedDate.getHours() : formatedDate.getHours()) + ":" + (formatedDate.getMinutes() <= 9 ? '0' + formatedDate.getMinutes() : formatedDate.getMinutes())
    
    ponto += `<tr><td id="dadosPontos">${u.id} </td><td id="dadosPontos" class="data">${dia} ${hora}</td><td id="dadosPontos" class="tipo"> ${u.tipoPonto}</td></tr>`
    console.log(u)
  } 
  document.getElementById('pontosRegistrados').innerHTML = ponto
}
carregar()


</script>
</html>
